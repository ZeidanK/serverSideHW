<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Movies Cards</title>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="Styles.css">
    
    
        
</head>
<body>
    <header>
        <div class="nav-buttons">
            <button class="nav-button active">Home</button>
            <button class="nav-button" onclick="location.href='MyMovies.html'">My Movies</button>
        </div>
    </header>

    <div class="container">
        <h1>Movies</h1>
        <button id="loadMoviesBtn" class="btn">Load Movies</button>
        <div id="movies-container" class="movie-grid">
            <!-- Movie cards will be appended here -->
        </div>
    </div>

    <!-- Include movies.js which sets up the movies variable -->
    <script src="movies.js"></script>

    <script>
        // Button click event to load movies
        $('#loadMoviesBtn').on('click', function () {
            var container = $('#movies-container');
            container.empty(); // Clear any previous content

            // Check if movies variable exists and is an array
            if (typeof movies !== 'undefined' && Array.isArray(movies)) {
                // Loop through each movie and create a card
                $.each(movies, function(index, movie) {
                    // Create the movie card
                    var card = $('<div>').addClass('movie-card');
                    
                    // Image if available
                    if (movie.primaryImage) {
                        var img = $('<img>')
                            .addClass('movie-img')
                            .attr('src', movie.primaryImage)
                            .attr('alt', movie.primaryTitle);
                        card.append(img);
                    }

                    // Card content
                    var content = $('<div>').addClass('movie-content');
                    content.append($('<div>').addClass('movie-title').text(movie.primaryTitle));
                    content.append($('<div>').addClass('movie-info').html('<strong>Year:</strong> ' + (movie.startYear || 'N/A')));
                    
                    // Movie description truncated if needed
                    var desc = movie.description ? movie.description.substring(0, 150) + '...' : 'No description available.';
                    content.append($('<div>').addClass('movie-info').html('<strong>Description:</strong> ' + desc));

                    // Movie rating
                    content.append($('<div>').addClass('movie-rating').html('<strong>Rating:</strong> ' + movie.averageRating));

                    // Display genres (if exists as an array, join with commas; if string, display as is)
                    var genresHtml = '';
                    if (Array.isArray(movie.genres)) {
                        genresHtml = movie.genres.join(', ');
                    } else {
                        genresHtml = movie.genres;
                    }
                    content.append($('<div>').addClass('movie-info').html('<strong>Genres:</strong> ' + genresHtml));
                    
                    // Footer with budget, box office and votes
                    var footer = $('<div>').addClass('movie-footer mt-2').html(
                        '<strong>Budget:</strong> $' + Number(movie.budget).toLocaleString() +
                        ' | <strong>Box Office:</strong> $' + Number(movie.grossWorldwide).toLocaleString() +
                        ' | <strong>Votes:</strong> ' + Number(movie.numVotes).toLocaleString()
                    );
                    content.append(footer);
                    
                    card.append(content);
                    container.append(card);
                });
            } else {
                container.html('<div style="grid-column: 1/-1; padding: 10px; background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba;">No movie data available.</div>');
            }
        });
    </script>
</body>
</html>
